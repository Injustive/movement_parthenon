export async function injectCaptchaSolverListener(a){await a.exposeFunction("captchaSolverPlaywrightTaskSs",async()=>{await a.waitForTimeout(1e3);return`data:image/png;base64,${(await a.screenshot()).toString("base64")}`}),await a.exposeFunction("captchaSolverPlaywrightTaskExec",async t=>{if("click"===t.action){const e=t.answers,i=t.canvasPosOnView;if(e?.length>0&&i)for(let t=0;t<e.length;t++)await a.mouse.click(e[t].x+i.x,e[t].y+i.y),await a.waitForTimeout(300)}else if("drag"===t.action){const e=t.paths,i=t.canvasPosOnView;if(e?.length>0&&i)for(let t=0;t<e.length;t++){const o=e[t];await a.mouse.move(o.start.x+i.x,o.start.y+i.y),await a.mouse.down(),await a.waitForTimeout(200),await a.mouse.move(o.end.x+i.x,o.end.y+i.y,{steps:15}),await a.mouse.up(),await a.waitForTimeout(300)}}return!0}),await a.addInitScript(()=>{window.addEventListener("cs-request-ba-ss",async()=>{"function"==typeof window.captchaSolverPlaywrightTaskSs&&setTimeout(async()=>{try{const a=await window.captchaSolverPlaywrightTaskSs();window.postMessage({from:"browser-automation",action:"ba-response-cs-ss",dataUrl:a},"*")}catch(a){}},10)}),window.addEventListener("cs-request-ba-op",async a=>{if("function"==typeof window.captchaSolverPlaywrightTaskExec)return await window.captchaSolverPlaywrightTaskExec(a.detail)})})}